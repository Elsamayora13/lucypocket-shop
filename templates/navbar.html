<nav class="fixed top-0 left-0 w-full z-50 border-b border-purple-700/30 bg-gradient-to-r from-purple-600 to-purple-700 backdrop-blur supports-[backdrop-filter]:bg-purple-700/90">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-14 flex items-center justify-between">
    <!-- Brand -->
    <a href="/" class="text-white text-xl font-semibold tracking-tight hover:opacity-90 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/80 rounded-md px-1">
      <span class="font-bold">Lucy Locket</span> <span class="font-normal opacity-90">Shop</span>
    </a>

    <!-- Desktop links -->
    <div class="hidden md:flex items-center gap-2">
      <!-- tips: "active" style akan ditambah via JS -->
      <a href="#" data-filter="all"
         class="nav-link rounded-md px-3 py-1.5 text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition">
        Home
      </a>
      <a href="#" data-filter="shoes"
         class="nav-link rounded-md px-3 py-1.5 text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition">
        Shoes
      </a>
      <a href="#" data-filter="accessories"
         class="nav-link rounded-md px-3 py-1.5 text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition">
        Accessories
      </a>
      <a href="#" data-filter="training"
         class="nav-link rounded-md px-3 py-1.5 text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition">
        Training
      </a>
      <a href="#" data-filter="other"
         class="nav-link rounded-md px-3 py-1.5 text-white/80 hover:text-white hover:bg-white/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition">
        Other
      </a>
    </div>

    <!-- Desktop user -->
    <div class="hidden md:flex items-center gap-4">
      {% if user.is_authenticated %}
        <div class="text-right leading-tight">
          <div class="text-white/95 text-sm font-medium">{{ user.username }}</div>
          <div class="text-white/70 text-[11px]">{{ class|default:"Lucy Locket Member" }}</div>
        </div>
        <form method="post" action="{% url 'main:logout' %}">
          {% csrf_token %}
          <button type="submit"
                  class="text-red/90 hover:text-white hover:bg-white/10 border border-white/20 px-3 py-1.5 rounded-md text-sm transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70">
            Logout
          </button>
        </form>
      {% else %}
        <a href="{% url 'main:login' %}" class="text-white/90 hover:text-white text-sm px-2 py-1.5 rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70">
          Login
        </a>
        <a href="{% url 'main:register' %}" class="bg-white text-purple-700 hover:bg-purple-50 text-sm px-3 py-1.5 rounded-md font-medium shadow-sm transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70">
          Register
        </a>
      {% endif %}
    </div>

    <!-- Hamburger (mobile) -->
    <button id="nav-btn" class="md:hidden p-2 text-white/90 hover:text-white rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70" aria-label="Open menu" aria-expanded="false">
      <div class="w-6 space-y-1.5">
        <div class="h-0.5 bg-current"></div>
        <div class="h-0.5 bg-current"></div>
        <div class="h-0.5 bg-current"></div>
      </div>
    </button>
  </div>

  <!-- Mobile menu -->
  <div id="nav-menu" class="md:hidden hidden border-t border-purple-700/20 bg-white/95 backdrop-blur">
    <div class="px-6 py-4">
      <!-- links -->
      <div class="space-y-1">
        <!-- "active" style mobile = bg-purple-50 text-purple-700 -->
        <a href="#" data-filter="all"         class="block py-2 px-2 rounded-md nav-link text-slate-700 hover:bg-slate-100">Home</a>
        <a href="#" data-filter="shoes"       class="block py-2 px-2 rounded-md nav-link text-slate-700 hover:bg-slate-100">Shoes</a>
        <a href="#" data-filter="accessories" class="block py-2 px-2 rounded-md nav-link text-slate-700 hover:bg-slate-100">Accessories</a>
        <a href="#" data-filter="training"    class="block py-2 px-2 rounded-md nav-link text-slate-700 hover:bg-slate-100">Training</a>
        <a href="#" data-filter="other"       class="block py-2 px-2 rounded-md nav-link text-slate-700 hover:bg-slate-100">Other</a>
      </div>

      <!-- user -->
      <div class="mt-6 pt-4 border-t border-slate-200">
        {% if user.is_authenticated %}
          <div class="mb-3">
            <div class="font-medium text-slate-900">{{ user.username }}</div>
            <div class="text-sm text-slate-500">Lucy Locket Member</div>
          </div>
          <form method="post" action="{% url 'main:logout' %}">
            {% csrf_token %}
            <button type="submit" class="text-red-600 hover:text-red-700">Logout</button>
          </form>
        {% else %}
          <a href="{% url 'main:login' %}" class="block py-2 text-slate-700 hover:text-slate-900">Login</a>
          <a href="{% url 'main:register' %}" class="mt-2 block bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-center shadow-sm">
            Register
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>

<!-- Script toggle & filter highlight -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // 1) HAMBURGER (mobile)
  const btn  = document.getElementById('nav-btn');
  const menu = document.getElementById('nav-menu');
  if (btn && menu) {
    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
      btn.setAttribute('aria-expanded', menu.classList.contains('hidden') ? 'false' : 'true');
    });
  }

  // 2) FILTER PRODUK (tampilkan/aktifkan style)
  const links = document.querySelectorAll('[data-filter]');
  const cards = document.querySelectorAll('.product-card'); // dipakai bila grid server-side

  function setActiveStyles(filter) {
    links.forEach(a => {
      const isActive = a.dataset.filter === filter;
      const isDesktop = a.closest('.md\\:flex') !== null;
      // reset
      a.classList.remove('bg-white/20','text-white','font-semibold','bg-purple-50','text-purple-700');
      if (isDesktop) {
        // desktop: aktif = text putih + bg blur
        if (isActive) a.classList.add('text-white','bg-white/20','font-semibold');
      } else {
        // mobile: aktif = pill ungu muda
        if (isActive) a.classList.add('bg-purple-50','text-purple-700','font-semibold');
      }
    });
  }

  function applyFilter(cat) {
    // kalau kamu render grid via server (Django), blok ini akan nyaring elemen yang sudah ada
    if (cards.length) {
      cards.forEach(card => {
        const catVal = (card.dataset.category || '').toLowerCase();
        const show = (cat === 'all') || (catVal === cat);
        card.classList.toggle('hidden', !show);
      });
    }
    setActiveStyles(cat);
  }

  links.forEach(a => {
    a.addEventListener('click', (e) => {
      e.preventDefault();
      const cat = a.dataset.filter;
      applyFilter(cat);
      if (menu && !menu.classList.contains('hidden')) menu.classList.add('hidden'); // tutup menu mobile
    });
  });

  // default
  applyFilter('all');
});
</script>
